<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Chaelin Kim</title>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Neue+Haas+Grotesk+Display+Pro:wght@400;500;600&display=swap" rel="stylesheet" />

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root { --bg:#fff; --text:#000; }

    body {
      font-family: -apple-system, "system-ui", Inter, "Segoe UI", Roboto, sans-serif;
      background: var(--bg);
      color: var(--text);
      font-size: 13px;
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
      cursor: url('data:image/svg+xml;utf8,\
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\
<path fill="%23FF6FD6" d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>\
</svg>') 12 12, auto;
    }

    a { text-decoration: none; color: inherit; cursor: inherit; }

    /* ✅ 헤더 배경 완전 투명 */
     header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: #fff;
    padding: 0 20px;
    z-index: 1000;
    }
    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 0;
    }

    .logo {
      width: 150px;
      height: 85px;
      overflow: hidden;
    }

    .logo video {
      width: 180px;
      margin-left: -15px;
    }

    nav {
      display: flex;
      gap: 30px;
      align-items: center;
    }

    nav a,
    .contact-email {
    font-size: 13px;
    font-weight: 600;
    line-height: 14.3px;
    }

    nav a:hover { opacity: 0.6; }

    /* 헤더가 투명해졌으니 여백 살짝 줄임 */
    main { padding-top: 0px; }

    .wrap {
      padding: 0 20px 60px;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 10px;
    }

    .card { display: block; }

    .thumb {
      width: 100%;
      aspect-ratio: 3 / 2;
      overflow: hidden;
      background: #f7f7f7;
    }

    .thumb img,
    .thumb video {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .info {
      margin-top: 10px;
      display: flex;
      justify-content: space-between;
      align-items: baseline;
    }

    .title { font-weight: 600; }
    .category { color: #666; }

    .loading {
      text-align: center;
      padding: 80px 0;
      color: #666;
    }

    .falling-star {
      position: fixed;
      pointer-events: none;
      z-index: 9999;
      animation: fall 1s ease-in forwards;
    }

    @keyframes fall {
      from { transform: translateY(0) rotate(0) scale(1); opacity: 1; }
      to { transform: translateY(100px) rotate(180deg) scale(0); opacity: 0; }
    }

    @media (max-width: 768px) {
      main { padding-top: 130px; }
      .grid { grid-template-columns: 1fr; }
    }
  </style>
</head>

<body>
<header>
  <div class="header-content">
    <div class="logo">
      <a href="index.html">
        <video autoplay loop muted playsinline>
          <source src="logo.mp4" type="video/mp4">
        </video>
      </a>
    </div>
    <nav>
      <a href="index.html">Art directing<br>& Brand Identity</a>
      <a href="index.html?category=interaction">Interaction</a>
      <a href="index.html?category=uxui">UX/UI</a>
      <a href="index.html?category=editorial">Editorial</a>
      <a href="index.html?category=film">Film</a>
      <a href="index.html?category=exhibition">Exhibition</a>
      <a href="index.html?page=about">About</a>
      <span class="contact-email">present1513@gmail.com</span>
    </nav>
  </div>
</header>

<main>
  <div class="wrap">
    <div class="loading" id="loading">Loading projects...</div>
    <div class="grid" id="grid" style="display:none;"></div>
  </div>
</main>

<script>
  let lastStar = 0;
  document.addEventListener('mousemove', e => {
    const now = Date.now();
    if (now - lastStar < 50) return;
    lastStar = now;

    const star = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
    star.setAttribute('class', 'falling-star');
    star.setAttribute('width', '12');
    star.setAttribute('height', '12');
    star.setAttribute('viewBox', '0 0 24 24');
    star.style.left = e.clientX + 'px';
    star.style.top = e.clientY + 'px';

    const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
    path.setAttribute('fill', '#FF6FD6');
    path.setAttribute(
      'd',
      'M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z'
    );

    star.appendChild(path);
    document.body.appendChild(star);
    setTimeout(() => star.remove(), 1000);
  });

  const loading = document.getElementById('loading');
  const grid = document.getElementById('grid');
  const params = new URLSearchParams(location.search);
  const category = params.get('category');

  const getThumb = (p) => {
    if (p && p.thumbnail && typeof p.thumbnail === 'object' && p.thumbnail.src) {
      return { type: p.thumbnail.type || '', src: p.thumbnail.src || '' };
    }
    if (p && typeof p.thumbnail === 'string') {
      const src = p.thumbnail;
      const ext = src.split('.').pop().toLowerCase();
      const type = (['mp4','webm','mov'].includes(ext)) ? 'video' : 'image';
      return { type, src };
    }
    return { type: 'image', src: '' };
  };

  const renderThumb = (p) => {
    const { type, src } = getThumb(p);
    if (!src) return '';

    if (type === 'video') {
      return `
        <video autoplay loop muted playsinline preload="metadata">
          <source src="${src}" type="video/mp4">
        </video>
      `;
    }

    return `<img src="${src}" alt="${p.title || ''}">`;
  };

  fetch('projects-data.json', { cache: 'no-store' })
    .then(r => r.json())
    .then(data => {
      const projects = data.projects || [];
      const filtered = category
        ? projects.filter(p => (p.category || '').toLowerCase() === category.toLowerCase())
        : projects;

      grid.innerHTML = filtered.map(p => `
        <a class="card" href="project.html?id=${encodeURIComponent(p.id)}">
          <div class="thumb">${renderThumb(p)}</div>
          <div class="info">
            <div>
              <div class="title">${p.title || ''}</div>
              <div class="category">${p.type || ''}</div>
            </div>
          </div>
        </a>
      `).join('');

      loading.style.display = 'none';
      grid.style.display = 'grid';
    })
    .catch(err => {
      console.error(err);
      loading.textContent = 'Failed to load projects.';
      loading.style.display = 'block';
      grid.style.display = 'none';
    });
</script>
</body>
</html>
