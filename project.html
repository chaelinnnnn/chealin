<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Project - Chaelin Kim</title>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Neue+Haas+Grotesk+Display+Pro:wght@400;500;600&display=swap" rel="stylesheet" />

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    :root {
      --bg: #FFFFFF;
      --text: #000;
      --border: #d0d0d0;
    }

    body {
      font-family: -apple-system, "system-ui", Inter, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
      background: var(--bg);
      color: var(--text);
      font-size: 14.5px;
      line-height: 1.6;
      font-weight: 400;
      -webkit-font-smoothing: antialiased;
      cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="%23FF6FD6" d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>') 12 12, auto;
    }

    a, button {
      cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="%23FF6FD6" d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>') 12 12, pointer;
    }

    .falling-star {
      position: fixed;
      pointer-events: none;
      z-index: 9999;
      animation: fall 1s ease-in forwards;
    }

    @keyframes fall {
      0% { transform: translateY(0) rotate(0deg) scale(1); opacity: 1; }
      100% { transform: translateY(100px) rotate(180deg) scale(0); opacity: 0; }
    }

    header {
      position: fixed;
      top: 0; left: 0; right: 0;
      background: var(--bg);
      z-index: 1000;
      padding: 0 20px;
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 0;
    }

    .logo {
      width: 150px;
      height: 85px;
      overflow: hidden;
    }

    .logo a {
      display: block;
      width: 100%;
      height: 100%;
    }

    .logo video {
      width: 180px;
      height: auto;
      margin-left: -15px;
    }

    nav {
      display: flex;
      gap: 30px;
      align-items: center;
    }

    nav a {
      text-decoration: none;
      color: var(--text);
      font-size: 13px;
      font-weight: 600;
      transition: opacity 0.2s;
      line-height: 1.1;
    }

    nav a:hover { opacity: 0.6; }

    .contact-email {
      font-size: 13px;
      font-weight: 600;
    }

    /* ✅ fixed header 아래로 본문 전체 내리기 (loading 포함) */
    main { padding-top: 180px; }

    .project-detail {
      margin-top: 0;
      padding: 0 20px 60px;
      max-width: 1200px;
      margin-left: auto;
      margin-right: auto;
      animation: fadeIn 0.6s ease forwards;
    }

    .project-title {
      font-size: 36px;
      font-weight: 600;
      margin-bottom: 30px;
      line-height: 1.2;
    }

    .project-description {
      font-size: 13px;
      line-height: 1.8;
      max-width: 800px;
    }

    .project-description p { margin-bottom: 20px; }

    .project-images {
      display: flex;
      flex-direction: column;
      gap: 40px;
      margin-top: 60px;
    }

    .project-image img {
      width: 100%;
      height: auto;
      display: block;
    }

    .image-caption {
      font-size: 13px;
      color: #666;
      margin-top: 15px;
    }

    .project-navigation {
      display: flex;
      justify-content: space-between;
      margin-top: 100px;
      padding-top: 40px;
      gap: 40px;
    }

    .nav-project {
      text-decoration: none;
      color: var(--text);
      transition: opacity 0.2s;
      flex: 1;
    }

    .nav-project:hover { opacity: 0.6; }

    .nav-title {
      font-size: 13px;
      font-weight: 500;
    }

    .nav-project.next { text-align: right; }

    .loading {
      text-align: center;
      padding: 100px 20px;
      font-size: 13px;
      color: #666;
    }

    @media (max-width: 768px) {
      main { padding-top: 160px; }
      .project-title { font-size: 28px; }
      .project-navigation { flex-direction: column; }
      .nav-project.next { text-align: left; }
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>

<body>
  <header>
    <div class="header-content">
      <div class="logo">
        <a href="index.html">
          <video autoplay loop muted playsinline preload="auto">
            <source src="logo.mp4" type="video/mp4" />
          </video>
        </a>
      </div>
      <nav>
        <a href="index.html" class="nav-link">Art directing<br>& Brand Identity</a>
        <a href="index.html?category=interaction" class="nav-link">Interaction</a>
        <a href="index.html?category=uxui" class="nav-link">UX/UI</a>
        <a href="index.html?category=editorial" class="nav-link">Editorial</a>
        <a href="index.html?category=film" class="nav-link">Film</a>
        <a href="index.html?category=exhibition" class="nav-link">Exhibition</a>
        <a href="index.html?page=about" class="nav-link">About</a>
        <span class="contact-email">present1513@gmail.com</span>
      </nav>
    </div>
  </header>

  <main>
    <div class="loading" id="loading">Loading project...</div>
    <div class="project-detail" id="projectContent" style="display:none;"></div>
  </main>

  <script>
    // Logo video loop tweak (safe)
    const logoVideo = document.querySelector('.logo video');
    if (logoVideo) {
      logoVideo.removeAttribute('loop');
      logoVideo.addEventListener('timeupdate', function () {
        if (!isFinite(this.duration)) return;
        if (this.currentTime >= this.duration - 0.1) this.currentTime = 0;
      });
      logoVideo.play().catch(() => {});
    }

    // Falling Stars (fixed -> DO NOT add scrollY)
    let lastStarTime = 0;
    document.addEventListener('mousemove', (e) => {
      const now = Date.now();
      if (now - lastStarTime < 50) return;
      lastStarTime = now;

      const star = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
      star.setAttribute('class', 'falling-star');
      star.setAttribute('width', '12');
      star.setAttribute('height', '12');
      star.setAttribute('viewBox', '0 0 24 24');
      star.style.left = e.clientX + 'px';
      star.style.top = e.clientY + 'px';

      const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
      path.setAttribute('fill', '#FF6FD6');
      path.setAttribute('d', 'M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z');

      star.appendChild(path);
      document.body.appendChild(star);
      setTimeout(() => star.remove(), 1000);
    });

    // Get project ID from URL
    const urlParams = new URLSearchParams(window.location.search);
    const projectId = urlParams.get('id');

    fetch('projects-data.json')
      .then(r => {
        if (!r.ok) throw new Error(`HTTP ${r.status}`);
        return r.json();
      })
      .then(data => {
        const projects = Array.isArray(data.projects) ? data.projects : [];

        if (projects.length === 0) {
          document.getElementById('loading').innerHTML =
            'No projects found. <a href="index.html">Go back</a>';
          return;
        }

        // ✅ 최종 핵심: id 없으면 첫 프로젝트를 그냥 렌더링 (리다이렉트 없음)
        const project = projectId
          ? projects.find(p => String(p.id) === String(projectId))
          : projects[0];

        if (!project) {
          document.getElementById('loading').innerHTML =
            'Project not found. <a href="index.html">Go back</a>';
          return;
        }

        displayProject(project, projects);
      })
      .catch(err => {
        console.error(err);
        document.getElementById('loading').innerHTML =
          'Error loading project. <a href="index.html">Go back</a>';
      });

    function displayProject(project, allProjects) {
      document.title = `${project.title} - Chaelin Kim`;

      const currentIndex = allProjects.findIndex(p => String(p.id) === String(project.id));
      const prevProject = allProjects[currentIndex - 1] || allProjects[allProjects.length - 1];
      const nextProject = allProjects[currentIndex + 1] || allProjects[0];

      let descriptionHTML = '';
      if (project.description && typeof project.description === 'object') {
        descriptionHTML = `
          ${project.description.ko ? `<p>${project.description.ko}</p>` : ''}
          ${project.description.en ? `<p>${project.description.en}</p>` : ''}
        `;
      } else if (project.description) {
        descriptionHTML = `<p>${project.description}</p>`;
      }

      const images = Array.isArray(project.images) ? project.images : [];
      const imagesHTML = images.map(img => `
        <div class="project-image">
          <img src="${img.src}" alt="${project.title}">
          ${img.caption ? `<div class="image-caption">${img.caption}</div>` : ''}
        </div>
      `).join('');

      const content = `
        <div class="project-header">
          <h1 class="project-title">${project.title}</h1>
          <div class="project-description">
            ${descriptionHTML}
          </div>
        </div>

        <div class="project-images">
          ${imagesHTML}
        </div>

        <div class="project-navigation">
          <a href="project.html?id=${prevProject.id}" class="nav-project prev">
            <div class="nav-title">${prevProject.title}</div>
          </a>
          <a href="project.html?id=${nextProject.id}" class="nav-project next">
            <div class="nav-title">${nextProject.title}</div>
          </a>
        </div>
      `;

      document.getElementById('loading').style.display = 'none';
      const projectContent = document.getElementById('projectContent');
      projectContent.innerHTML = content;
      projectContent.style.display = 'block';
    }
  </script>
</body>
</html>
